<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>使用 Rasa 构建天气查询机器人 | Xiaoquan Kong&#39;s Blog</title>
<meta name="keywords" content="Rasa, Rasa NLU, Rasa Core">
<meta name="description" content="本文将介绍如何使用 Rasa NLU 和 Rasa Core 来构建一个简单的带 Web UI 界面的中文天气情况问询机器人(chatbot)。">
<meta name="author" content="Xiaoquan Kong">
<link rel="canonical" href="https://blog.xiaoquankong.ai/zh/posts/creating-a-weather-query-bot-using-rasa/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.9c4f5aa85dab72ee82fc33b8dfb12a3f7459e6c1b389f9fae73095efa3ecb4d6.css" integrity="sha256-nE9aqF2rcu6C/DO437EqP3RZ5sGzifn65zCV76PstNY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.xiaoquankong.ai/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.xiaoquankong.ai/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.xiaoquankong.ai/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.xiaoquankong.ai/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.xiaoquankong.ai/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://blog.xiaoquankong.ai/zh/posts/creating-a-weather-query-bot-using-rasa/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-105150423-2', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="使用 Rasa 构建天气查询机器人" />
<meta property="og:description" content="本文将介绍如何使用 Rasa NLU 和 Rasa Core 来构建一个简单的带 Web UI 界面的中文天气情况问询机器人(chatbot)。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.xiaoquankong.ai/zh/posts/creating-a-weather-query-bot-using-rasa/" /><meta property="og:image" content="https://blog.xiaoquankong.ai/papermod-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-09T11:08:04+00:00" />
<meta property="article:modified_time" content="2018-09-09T11:08:04+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://blog.xiaoquankong.ai/papermod-cover.png"/>

<meta name="twitter:title" content="使用 Rasa 构建天气查询机器人"/>
<meta name="twitter:description" content="本文将介绍如何使用 Rasa NLU 和 Rasa Core 来构建一个简单的带 Web UI 界面的中文天气情况问询机器人(chatbot)。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blog.xiaoquankong.ai/zh/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "使用 Rasa 构建天气查询机器人",
      "item": "https://blog.xiaoquankong.ai/zh/posts/creating-a-weather-query-bot-using-rasa/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "使用 Rasa 构建天气查询机器人",
  "name": "使用 Rasa 构建天气查询机器人",
  "description": "本文将介绍如何使用 Rasa NLU 和 Rasa Core 来构建一个简单的带 Web UI 界面的中文天气情况问询机器人(chatbot)。\n",
  "keywords": [
    "Rasa", "Rasa NLU", "Rasa Core"
  ],
  "articleBody": "本文将介绍如何使用 Rasa NLU 和 Rasa Core 来构建一个简单的带 Web UI 界面的中文天气情况问询机器人(chatbot)。\n源代码地址 https://github.com/howl-anderson/WeatherBot\n功能 这个机器人可以根据你提供的城市（北京、上海等）和日期（明天、后天等），查询出相应的天气预报。\n功能截图 特性 使用 Frame-based 对话管理方案，如果上述两个 Slot (既城市和天气)，有任意一个用户未提供，对话管理系统会负责让你澄清相关 Slot 的值。\n能力范围 受限于天气数据提供方的能力，这个机器人只能查询 中国大陆地区市级城市 三天以内 （今天，明天，后天） 的气象数据，不能查询过去（昨天，前天）等历史数据。 受限于开发时间，这个机器人 不提供 诸如 这个星期五、下个星期一 这种需要计算才能得到日期给定方式。也 不能提供 诸如 绝对日期：三月一号、六一儿童节日 这种日期的查询能力。 因为使用的是免费的天气查询接口，所以 会有配额限制，可能会因为 超出调用次数 ，而在一个小时内不能用。同时网络查询接口可能存在不稳定因素，导致 没有结果返回或者出现异常，尝试多次重新发送请求可解决问题。 在线演示 Demo for 天气预报查询机器人\nRasa NLU Rasa NLU 提供了提取用户意图和词槽的功能。具体原理和使用等不在这里详述，请访问文章 TODO。 这里我们使用的 Rasa NLU 的 pipeline 配置（在项目文件 nlu_model_config.yaml 中）如下:\nlanguage: \"zh\" pipeline: - name: \"nlp_mitie\" model: \"data/total_word_feature_extractor.dat\" - name: \"tokenizer_jieba\" - name: \"ner_mitie\" - name: \"ner_synonyms\" - name: \"intent_featurizer_mitie\" - name: \"intent_classifier_sklearn\" 所用的训练数据 （在项目文件 nlu.json 中）如下（内容过长，已做截断）：\n{ \"rasa_nlu_data\": { \"common_examples\": [ { \"intent\": \"weather_address_date-time\", \"entities\": [ { \"start\": 2, \"end\": 4, \"value\": \"上海\", \"entity\": \"address\" }, { \"start\": 4, \"end\": 6, \"value\": \"明天\", \"entity\": \"date-time\" } ], \"text\": \"我要上海明天的天气\" }, { \"intent\": \"weather_address_date-time\", \"entities\": [ { \"start\": 0, \"end\": 2, \"value\": \"上海\", \"entity\": \"address\" }, { \"start\": 2, \"end\": 4, \"value\": \"明天\", \"entity\": \"date-time\" } ], \"text\": \"上海明天的天气\" }, ... } } 训练所用的命令为 (在项目文件 train_NLU.bash 中):\npython -m rasa_nlu.train -c nlu_model_config.yaml -d nlu.json --fixed_model_name current -o models Rasa Core Rasa Core 负责对话管理。具体原理和使用等不在这里详述，请访问文章 TODO。 Rasa core 需要提供一个 domain 文件，里面设定了整个对话机器人的小宇宙，它能知道的所有的意图、词槽和动作。\n本项目所用的 domain (在项目文件 domain.yml 中)，其内容为：\nintents: - greet - goodbye - weather_address_date-time - weather_address - weather_date-time slots: address: type: text date-time: type: text matches: type: unfeaturized entities: - address - date-time actions: - utter_greet - utter_ask_address - utter_ask_date-time - utter_working_on_it - bot.ActionReportWeather - utter_report_weather - utter_goodbye templates: utter_greet: - text: \"你好，请说出需要提供天气预测服务的地点和时间\" utter_working_on_it: - text: \"正在查询中，请稍后 ...\" utter_goodbye: - text: \"再见！\" utter_ask_address: - text: \"哪里呢？\" utter_ask_date-time: - text: \"什么时候？\" utter_report_weather: - text: \"{matches}\" utter_other: - text: \"系统不明白您说的话\" Rasa Core 还需要通过 故事(story) 的形式让框架学习正确的对话管理样本，格式为 Markdown 格式。本项目中的 Story （在项目文件 stories.md 中）定义如下（内容过长，已做截断）：\n## simple path with greet * greet - utter_greet * weather_address_date-time{\"address\": \"上海\", \"date-time\": \"明天\"} - utter_working_on_it - action_report_weather - utter_report_weather ## simple path * weather_address_date-time{\"address\": \"上海\", \"date-time\": \"明天\"} - utter_working_on_it - action_report_weather - utter_report_weather ## address + date-time path with greet * greet - utter_greet * weather_address{\"address\": \"上海\"} - utter_ask_date-time * weather_date-time{\"date-time\": \"明天\"} - utter_working_on_it - action_report_weather - utter_report_weather ... 训练所用的命令为 (在项目文件 train_CORE.bash 中):\npython -m rasa_core.train -s stories.md -d domain.yml -o models/dialogue --epochs 500 依赖 python 版本 python 3\npython 依赖 pip install -r requirements.txt 下载数据和模型 data/total_word_feature_extractor.dat: 从 https://github.com/howl-anderson/MITIE_Chinese_Wikipedia_corpus 下载，解压缩后放置到对应位置 models/default/current：通过运行 train_NLU.bash 生成 models/dialogue：通过运行 train_CORE.bash 生成 功能入口 申请 API key 本项目目前使用 心知天气 提供天气数据，该平台为个人提供免费的 API，但任然需要用户注册并申请 API key 才能使用。用户注册后可以自行找到 我的API密钥。\n启动服务 将如下的 xxx 替换成你的 API key，然后执行即可\nSENIVERSE_KEY=xxx python ./webchat.py 启动成功后，请用浏览器访问 http://localhost:5500 , 你将得到 web 页面，have fun!\n",
  "wordCount" : "392",
  "inLanguage": "zh",
  "datePublished": "2018-09-09T11:08:04Z",
  "dateModified": "2018-09-09T11:08:04Z",
  "author":{
    "@type": "Person",
    "name": "Xiaoquan Kong"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.xiaoquankong.ai/zh/posts/creating-a-weather-query-bot-using-rasa/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Xiaoquan Kong's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.xiaoquankong.ai/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.xiaoquankong.ai/zh/" accesskey="h" title="Xiaoquan Kong&#39;s Blog (Alt + H)">Xiaoquan Kong&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://blog.xiaoquankong.ai/" title="English"
                            aria-label="English">English</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.xiaoquankong.ai/zh/archives/" title="时间线">
                    <span>时间线</span>
                </a>
            </li>
            <li>
                <a href="https://blog.xiaoquankong.ai/zh/categories" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://blog.xiaoquankong.ai/zh/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://www.xiaoquankong.ai" title="关于我">
                    <span>关于我</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.xiaoquankong.ai/zh/">主页</a>&nbsp;»&nbsp;<a href="https://blog.xiaoquankong.ai/zh/posts/">Posts</a></div>
    <h1 class="post-title">
      使用 Rasa 构建天气查询机器人
    </h1>
    <div class="post-meta"><span title='2018-09-09 11:08:04 +0000 UTC'>九月 9, 2018</span>&nbsp;·&nbsp;2 分钟&nbsp;·&nbsp;Xiaoquan Kong

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e6%ba%90%e4%bb%a3%e7%a0%81%e5%9c%b0%e5%9d%80" aria-label="源代码地址">源代码地址</a></li>
                <li>
                    <a href="#%e5%8a%9f%e8%83%bd" aria-label="功能">功能</a></li>
                <li>
                    <a href="#%e5%8a%9f%e8%83%bd%e6%88%aa%e5%9b%be" aria-label="功能截图">功能截图</a></li>
                <li>
                    <a href="#%e7%89%b9%e6%80%a7" aria-label="特性">特性</a></li>
                <li>
                    <a href="#%e8%83%bd%e5%8a%9b%e8%8c%83%e5%9b%b4" aria-label="能力范围">能力范围</a></li>
                <li>
                    <a href="#%e5%9c%a8%e7%ba%bf%e6%bc%94%e7%a4%ba" aria-label="在线演示">在线演示</a></li>
                <li>
                    <a href="#rasa-nlu" aria-label="Rasa NLU">Rasa NLU</a></li>
                <li>
                    <a href="#rasa-core" aria-label="Rasa Core">Rasa Core</a></li>
                <li>
                    <a href="#%e4%be%9d%e8%b5%96" aria-label="依赖">依赖</a><ul>
                        
                <li>
                    <a href="#python-%e7%89%88%e6%9c%ac" aria-label="python 版本">python 版本</a></li>
                <li>
                    <a href="#python-%e4%be%9d%e8%b5%96" aria-label="python 依赖">python 依赖</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%b8%8b%e8%bd%bd%e6%95%b0%e6%8d%ae%e5%92%8c%e6%a8%a1%e5%9e%8b" aria-label="下载数据和模型">下载数据和模型</a></li>
                <li>
                    <a href="#%e5%8a%9f%e8%83%bd%e5%85%a5%e5%8f%a3" aria-label="功能入口">功能入口</a><ul>
                        
                <li>
                    <a href="#%e7%94%b3%e8%af%b7-api-key" aria-label="申请 API key">申请 API key</a></li>
                <li>
                    <a href="#%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1" aria-label="启动服务">启动服务</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>本文将介绍如何使用 Rasa NLU 和 Rasa Core 来构建一个简单的带 Web UI 界面的中文天气情况问询机器人(chatbot)。</p>
<h2 id="源代码地址">源代码地址<a hidden class="anchor" aria-hidden="true" href="#源代码地址">#</a></h2>
<p><a href="https://github.com/howl-anderson/WeatherBot">https://github.com/howl-anderson/WeatherBot</a></p>
<h2 id="功能">功能<a hidden class="anchor" aria-hidden="true" href="#功能">#</a></h2>
<p>这个机器人可以根据你提供的城市（北京、上海等）和日期（明天、后天等），查询出相应的天气预报。</p>
<h2 id="功能截图">功能截图<a hidden class="anchor" aria-hidden="true" href="#功能截图">#</a></h2>
<img src="./weather_bot_query_interface.png" width="50%">
<h2 id="特性">特性<a hidden class="anchor" aria-hidden="true" href="#特性">#</a></h2>
<p>使用 Frame-based 对话管理方案，如果上述两个 Slot (既城市和天气)，有任意一个用户未提供，对话管理系统会负责让你澄清相关 Slot 的值。</p>
<h2 id="能力范围">能力范围<a hidden class="anchor" aria-hidden="true" href="#能力范围">#</a></h2>
<ul>
<li>受限于天气数据提供方的能力，这个机器人只能查询 <strong>中国大陆地区市级城市</strong> 三天以内 <strong>（今天，明天，后天）</strong> 的气象数据，<strong>不能查询过去</strong>（昨天，前天）等历史数据。</li>
<li>受限于开发时间，这个机器人 <strong>不提供</strong> 诸如 <strong>这个星期五、下个星期一</strong> 这种需要计算才能得到日期给定方式。也 <strong>不能提供</strong> 诸如 <strong>绝对日期：三月一号、六一儿童节日</strong> 这种日期的查询能力。</li>
<li>因为使用的是免费的天气查询接口，所以 <strong>会有配额限制</strong>，可能会因为 <strong>超出调用次数</strong> ，而在一个小时内不能用。同时网络查询接口可能存在不稳定因素，导致 <strong>没有结果返回或者出现异常</strong>，<strong>尝试多次重新发送请求可解决问题</strong>。</li>
</ul>
<h2 id="在线演示">在线演示<a hidden class="anchor" aria-hidden="true" href="#在线演示">#</a></h2>
<p><a href="http://weather_bot.xiaoquankong.ai/">Demo for 天气预报查询机器人</a></p>
<h2 id="rasa-nlu">Rasa NLU<a hidden class="anchor" aria-hidden="true" href="#rasa-nlu">#</a></h2>
<p>Rasa NLU 提供了提取用户意图和词槽的功能。具体原理和使用等不在这里详述，请访问文章 <a href="#">TODO</a>。
这里我们使用的 Rasa NLU 的 pipeline 配置（在项目文件 <a href="https://github.com/howl-anderson/WeatherBot/blob/master/nlu_model_config.yaml">nlu_model_config.yaml</a> 中）如下:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;zh&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">pipeline</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;nlp_mitie&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;data/total_word_feature_extractor.dat&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tokenizer_jieba&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ner_mitie&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ner_synonyms&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;intent_featurizer_mitie&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;intent_classifier_sklearn&#34;</span><span class="w">
</span></span></span></code></pre></div><p>所用的训练数据 （在项目文件 <a href="https://github.com/howl-anderson/WeatherBot/blob/master/nlu.json">nlu.json</a> 中）如下（内容过长，已做截断）：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl">{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">&#34;rasa_nlu_data&#34;: </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">&#34;common_examples&#34;: </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">&#34;intent&#34;: </span><span class="s2">&#34;weather_address_date-time&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">&#34;entities&#34;: </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;start&#34;: </span><span class="m">2</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;end&#34;: </span><span class="m">4</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;value&#34;: </span><span class="s2">&#34;上海&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;entity&#34;: </span><span class="s2">&#34;address&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>}<span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;start&#34;: </span><span class="m">4</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;end&#34;: </span><span class="m">6</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;value&#34;: </span><span class="s2">&#34;明天&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;entity&#34;: </span><span class="s2">&#34;date-time&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">&#34;text&#34;: </span><span class="s2">&#34;我要上海明天的天气&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>}<span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">&#34;intent&#34;: </span><span class="s2">&#34;weather_address_date-time&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">&#34;entities&#34;: </span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;start&#34;: </span><span class="m">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;end&#34;: </span><span class="m">2</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;value&#34;: </span><span class="s2">&#34;上海&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;entity&#34;: </span><span class="s2">&#34;address&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>}<span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;start&#34;: </span><span class="m">2</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;end&#34;: </span><span class="m">4</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;value&#34;: </span><span class="s2">&#34;明天&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">&#34;entity&#34;: </span><span class="s2">&#34;date-time&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">&#34;text&#34;: </span><span class="s2">&#34;上海明天的天气&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>}<span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="l">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>}<span class="w">
</span></span></span></code></pre></div><p>训练所用的命令为 (在项目文件 <a href="https://github.com/howl-anderson/WeatherBot/blob/master/train_NLU.bash">train_NLU.bash</a> 中):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python -m rasa_nlu.train -c nlu_model_config.yaml -d nlu.json --fixed_model_name current -o models
</span></span></code></pre></div><h2 id="rasa-core">Rasa Core<a hidden class="anchor" aria-hidden="true" href="#rasa-core">#</a></h2>
<p>Rasa Core 负责对话管理。具体原理和使用等不在这里详述，请访问文章 <a href="#">TODO</a>。
Rasa core 需要提供一个 domain 文件，里面设定了整个对话机器人的小宇宙，它能知道的所有的意图、词槽和动作。</p>
<p>本项目所用的 domain (在项目文件 <a href="https://github.com/howl-anderson/WeatherBot/blob/master/domain.yml">domain.yml</a> 中)，其内容为：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">intents:</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">greet</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">goodbye</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">weather_address_date-time</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">weather_address</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">weather_date-time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">slots:</span>
</span></span><span class="line"><span class="cl">  <span class="err">address:</span>
</span></span><span class="line"><span class="cl">    <span class="err">type:</span> <span class="err">text</span>
</span></span><span class="line"><span class="cl">  <span class="err">date-time:</span>
</span></span><span class="line"><span class="cl">    <span class="err">type:</span> <span class="err">text</span>
</span></span><span class="line"><span class="cl">  <span class="err">matches:</span>
</span></span><span class="line"><span class="cl">    <span class="err">type:</span> <span class="err">unfeaturized</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">entities:</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">address</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">date-time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">actions:</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">utter_greet</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">utter_ask_address</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">utter_ask_date-time</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">utter_working_on_it</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">bot.ActionReportWeather</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">utter_report_weather</span>
</span></span><span class="line"><span class="cl">  <span class="err">-</span> <span class="err">utter_goodbye</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">templates:</span>
</span></span><span class="line"><span class="cl">  <span class="err">utter_greet:</span>
</span></span><span class="line"><span class="cl">    <span class="err">-</span> <span class="err">text:</span> <span class="s2">&#34;你好，请说出需要提供天气预测服务的地点和时间&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="err">utter_working_on_it:</span>
</span></span><span class="line"><span class="cl">    <span class="err">-</span> <span class="err">text:</span> <span class="s2">&#34;正在查询中，请稍后 ...&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="err">utter_goodbye:</span>
</span></span><span class="line"><span class="cl">    <span class="err">-</span> <span class="err">text:</span> <span class="s2">&#34;再见！&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="err">utter_ask_address:</span>
</span></span><span class="line"><span class="cl">    <span class="err">-</span> <span class="err">text:</span> <span class="s2">&#34;哪里呢？&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="err">utter_ask_date-time:</span>
</span></span><span class="line"><span class="cl">    <span class="err">-</span> <span class="err">text:</span> <span class="s2">&#34;什么时候？&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="err">utter_report_weather:</span>
</span></span><span class="line"><span class="cl">    <span class="err">-</span> <span class="err">text:</span> <span class="s2">&#34;{matches}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="err">utter_other:</span>
</span></span><span class="line"><span class="cl">    <span class="err">-</span> <span class="err">text:</span> <span class="s2">&#34;系统不明白您说的话&#34;</span>
</span></span></code></pre></div><p>Rasa Core 还需要通过 <code>故事(story)</code> 的形式让框架学习正确的对话管理样本，格式为 Markdown 格式。本项目中的 Story  （在项目文件 <a href="https://github.com/howl-anderson/WeatherBot/blob/master/stories.md">stories.md</a> 中）定义如下（内容过长，已做截断）：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gu">## simple path with greet
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="k">*</span> greet
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_greet
</span></span><span class="line"><span class="cl"><span class="k">*</span> weather_address_date-time{&#34;address&#34;: &#34;上海&#34;, &#34;date-time&#34;: &#34;明天&#34;}
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_working_on_it
</span></span><span class="line"><span class="cl">  <span class="k">-</span> action_report_weather
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_report_weather
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## simple path
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="k">*</span> weather_address_date-time{&#34;address&#34;: &#34;上海&#34;, &#34;date-time&#34;: &#34;明天&#34;}
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_working_on_it
</span></span><span class="line"><span class="cl">  <span class="k">-</span> action_report_weather
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_report_weather
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## address + date-time path with greet
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="k">*</span> greet
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_greet
</span></span><span class="line"><span class="cl"><span class="k">*</span> weather_address{&#34;address&#34;: &#34;上海&#34;}
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_ask_date-time
</span></span><span class="line"><span class="cl"><span class="k">*</span> weather_date-time{&#34;date-time&#34;: &#34;明天&#34;}
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_working_on_it
</span></span><span class="line"><span class="cl">  <span class="k">-</span> action_report_weather
</span></span><span class="line"><span class="cl">  <span class="k">-</span> utter_report_weather
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>训练所用的命令为 (在项目文件 <a href="https://github.com/howl-anderson/WeatherBot/blob/master/train_CORE.bash">train_CORE.bash</a> 中):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python -m rasa_core.train -s stories.md -d domain.yml -o models/dialogue --epochs <span class="m">500</span>
</span></span></code></pre></div><h2 id="依赖">依赖<a hidden class="anchor" aria-hidden="true" href="#依赖">#</a></h2>
<h3 id="python-版本">python 版本<a hidden class="anchor" aria-hidden="true" href="#python-版本">#</a></h3>
<p>python 3</p>
<h3 id="python-依赖">python 依赖<a hidden class="anchor" aria-hidden="true" href="#python-依赖">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">pip install -r requirements.txt
</span></span></span></code></pre></div><h2 id="下载数据和模型">下载数据和模型<a hidden class="anchor" aria-hidden="true" href="#下载数据和模型">#</a></h2>
<ul>
<li><code>data/total_word_feature_extractor.dat</code>: 从 <a href="https://github.com/howl-anderson/MITIE_Chinese_Wikipedia_corpus/releases">https://github.com/howl-anderson/MITIE_Chinese_Wikipedia_corpus</a> 下载，解压缩后放置到对应位置</li>
<li><code>models/default/current</code>：通过运行 <code>train_NLU.bash</code> 生成</li>
<li><code>models/dialogue</code>：通过运行 <code>train_CORE.bash</code> 生成</li>
</ul>
<h2 id="功能入口">功能入口<a hidden class="anchor" aria-hidden="true" href="#功能入口">#</a></h2>
<h3 id="申请-api-key">申请 API key<a hidden class="anchor" aria-hidden="true" href="#申请-api-key">#</a></h3>
<p>本项目目前使用 <a href="https://www.seniverse.com/">心知天气</a> 提供天气数据，该平台为个人提供免费的 API，但任然需要用户注册并申请 API key 才能使用。用户注册后可以自行找到 <code>我的API密钥</code>。</p>
<h3 id="启动服务">启动服务<a hidden class="anchor" aria-hidden="true" href="#启动服务">#</a></h3>
<p>将如下的 <code>xxx</code> 替换成你的 API key，然后执行即可</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">SENIVERSE_KEY</span><span class="o">=</span>xxx python ./webchat.py
</span></span></code></pre></div><p>启动成功后，请用浏览器访问 <a href="http://localhost:5500">http://localhost:5500</a> , 你将得到 web 页面，have fun!</p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.xiaoquankong.ai/zh/tags/rasa/">Rasa</a></li>
      <li><a href="https://blog.xiaoquankong.ai/zh/tags/rasa-nlu/">Rasa NLU</a></li>
      <li><a href="https://blog.xiaoquankong.ai/zh/tags/rasa-core/">Rasa Core</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://blog.xiaoquankong.ai/zh/posts/pipeline-and-components-in-rasa-nlu/">
    <span class="title">下一页 »</span>
    <br>
    <span>Rasa NLU 的 pipeline 和 component</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share 使用 Rasa 构建天气查询机器人 on twitter"
        href="https://twitter.com/intent/tweet/?text=%e4%bd%bf%e7%94%a8%20Rasa%20%e6%9e%84%e5%bb%ba%e5%a4%a9%e6%b0%94%e6%9f%a5%e8%af%a2%e6%9c%ba%e5%99%a8%e4%ba%ba&amp;url=https%3a%2f%2fblog.xiaoquankong.ai%2fzh%2fposts%2fcreating-a-weather-query-bot-using-rasa%2f&amp;hashtags=Rasa%2cRasaNLU%2cRasaCore">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 使用 Rasa 构建天气查询机器人 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.xiaoquankong.ai%2fzh%2fposts%2fcreating-a-weather-query-bot-using-rasa%2f&amp;title=%e4%bd%bf%e7%94%a8%20Rasa%20%e6%9e%84%e5%bb%ba%e5%a4%a9%e6%b0%94%e6%9f%a5%e8%af%a2%e6%9c%ba%e5%99%a8%e4%ba%ba&amp;summary=%e4%bd%bf%e7%94%a8%20Rasa%20%e6%9e%84%e5%bb%ba%e5%a4%a9%e6%b0%94%e6%9f%a5%e8%af%a2%e6%9c%ba%e5%99%a8%e4%ba%ba&amp;source=https%3a%2f%2fblog.xiaoquankong.ai%2fzh%2fposts%2fcreating-a-weather-query-bot-using-rasa%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 使用 Rasa 构建天气查询机器人 on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fblog.xiaoquankong.ai%2fzh%2fposts%2fcreating-a-weather-query-bot-using-rasa%2f&title=%e4%bd%bf%e7%94%a8%20Rasa%20%e6%9e%84%e5%bb%ba%e5%a4%a9%e6%b0%94%e6%9f%a5%e8%af%a2%e6%9c%ba%e5%99%a8%e4%ba%ba">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 使用 Rasa 构建天气查询机器人 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.xiaoquankong.ai%2fzh%2fposts%2fcreating-a-weather-query-bot-using-rasa%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 使用 Rasa 构建天气查询机器人 on whatsapp"
        href="https://api.whatsapp.com/send?text=%e4%bd%bf%e7%94%a8%20Rasa%20%e6%9e%84%e5%bb%ba%e5%a4%a9%e6%b0%94%e6%9f%a5%e8%af%a2%e6%9c%ba%e5%99%a8%e4%ba%ba%20-%20https%3a%2f%2fblog.xiaoquankong.ai%2fzh%2fposts%2fcreating-a-weather-query-bot-using-rasa%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share 使用 Rasa 构建天气查询机器人 on telegram"
        href="https://telegram.me/share/url?text=%e4%bd%bf%e7%94%a8%20Rasa%20%e6%9e%84%e5%bb%ba%e5%a4%a9%e6%b0%94%e6%9f%a5%e8%af%a2%e6%9c%ba%e5%99%a8%e4%ba%ba&amp;url=https%3a%2f%2fblog.xiaoquankong.ai%2fzh%2fposts%2fcreating-a-weather-query-bot-using-rasa%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://blog.xiaoquankong.ai/zh/">Xiaoquan Kong&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
